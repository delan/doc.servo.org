<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Converts potentially-invalid UTF-16 to valid UTF-8 with errors replaced with the REPLACEMENT CHARACTER with potentially insufficient output space."><title>encoding_mem_convert_utf16_to_utf8_partial in encoding_c_mem - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2"href="../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../static.files/rustdoc-e56847b5.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="encoding_c_mem" data-themes="" data-resource-suffix="" data-rustdoc-version="1.91.0 (f8297e351 2025-10-28)" data-channel="1.91.0" data-search-js="search-e256b49e.js" data-stringdex-js="stringdex-c3e638e9.js" data-settings-js="settings-c38705f0.js" ><script src="../static.files/storage-e2aeef58.js"></script><script defer src="sidebar-items.js"></script><script defer src="../static.files/main-6dc2a7f3.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-263c88ec.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-eab170b8.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-044be391.svg"></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><rustdoc-topbar><h2><a href="#">encoding_mem_convert_utf16_to_utf8_partial</a></h2></rustdoc-topbar><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../encoding_c_mem/index.html">encoding_<wbr>c_<wbr>mem</a><span class="version">0.2.6</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">encoding_<wbr>mem_<wbr>convert_<wbr>utf16_<wbr>to_<wbr>utf8_<wbr>partial</a></h2><h3><a href="#">Sections</a></h3><ul class="block top-toc"><li><a href="#safety" title="Safety">Safety</a></li><li><a href="#undefined-behavior" title="Undefined behavior">Undefined behavior</a></li></ul></section><div id="rustdoc-modnav"><h2 class="in-crate"><a href="index.html">In crate encoding_<wbr>c_<wbr>mem</a></h2></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="index.html">encoding_c_mem</a></div><h1>Function <span class="fn">encoding_<wbr>mem_<wbr>convert_<wbr>utf16_<wbr>to_<wbr>utf8_<wbr>partial</span>&nbsp;<button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../src/encoding_c_mem/lib.rs.html#426-438">Source</a> </span></div><pre class="rust item-decl"><code><div class="code-attribute">#[unsafe(no_mangle)]</div>pub unsafe extern &quot;C&quot; fn encoding_mem_convert_utf16_to_utf8_partial(
    src: <a class="primitive" href="https://doc.rust-lang.org/1.91.0/std/primitive.pointer.html">*const </a><a class="primitive" href="https://doc.rust-lang.org/1.91.0/std/primitive.u16.html">u16</a>,
    src_len: <a class="primitive" href="https://doc.rust-lang.org/1.91.0/std/primitive.pointer.html">*mut </a><a class="primitive" href="https://doc.rust-lang.org/1.91.0/std/primitive.usize.html">usize</a>,
    dst: <a class="primitive" href="https://doc.rust-lang.org/1.91.0/std/primitive.pointer.html">*mut </a><a class="primitive" href="https://doc.rust-lang.org/1.91.0/std/primitive.u8.html">u8</a>,
    dst_len: <a class="primitive" href="https://doc.rust-lang.org/1.91.0/std/primitive.pointer.html">*mut </a><a class="primitive" href="https://doc.rust-lang.org/1.91.0/std/primitive.usize.html">usize</a>,
)</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Converts potentially-invalid UTF-16 to valid UTF-8 with errors replaced
with the REPLACEMENT CHARACTER with potentially insufficient output
space.</p>
<p>Writes the number of code units read into <code>*src_len</code> and the number of
bytes written into <code>*dst_len</code>.</p>
<p>Guarantees that the bytes in the destination beyond the number of
bytes claimed as written by the second item of the return tuple
are left unmodified.</p>
<p>Not all code units are read if there isn’t enough output space.</p>
<p>Note  that this method isn’t designed for general streamability but for
not allocating memory for the worst case up front. Specifically,
if the input starts with or ends with an unpaired surrogate, those are
replaced with the REPLACEMENT CHARACTER.</p>
<p>Matches the semantics of <code>TextEncoder.encodeInto()</code> from the
Encoding Standard.</p>
<h2 id="safety"><a class="doc-anchor" href="#safety">§</a>Safety</h2>
<p>If you want to convert into a <code>&amp;mut str</code>, use
<code>convert_utf16_to_str_partial()</code> instead of using this function
together with the <code>unsafe</code> method <code>as_bytes_mut()</code> on <code>&amp;mut str</code>.</p>
<h2 id="undefined-behavior"><a class="doc-anchor" href="#undefined-behavior">§</a>Undefined behavior</h2>
<p>UB ensues if <code>src</code> and <code>src_len</code> don’t designate a valid memory block, if
<code>src</code> is <code>NULL</code>, if <code>dst</code> and <code>dst_len</code> don’t designate a valid memory
block, if <code>dst</code> is <code>NULL</code> or if the two memory blocks overlap. (If
<code>src_len</code> is <code>0</code>, <code>src</code> may be bogus but still has to be non-<code>NULL</code> and
aligned. Likewise for <code>dst</code> and <code>dst_len</code>.)</p>
</div></details></section></div></main></body></html>