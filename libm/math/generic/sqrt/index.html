<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Generic square root algorithm."><title>libm::math::generic::sqrt - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2"href="../../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../../../static.files/rustdoc-e56847b5.css"><meta name="rustdoc-vars" data-root-path="../../../../" data-static-root-path="../../../../static.files/" data-current-crate="libm" data-themes="" data-resource-suffix="" data-rustdoc-version="1.91.0 (f8297e351 2025-10-28)" data-channel="1.91.0" data-search-js="search-e256b49e.js" data-stringdex-js="stringdex-c3e638e9.js" data-settings-js="settings-c38705f0.js" ><script src="../../../../static.files/storage-e2aeef58.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../../../static.files/main-6dc2a7f3.js"></script><noscript><link rel="stylesheet" href="../../../../static.files/noscript-263c88ec.css"></noscript><link rel="alternate icon" type="image/png" href="../../../../static.files/favicon-32x32-eab170b8.png"><link rel="icon" type="image/svg+xml" href="../../../../static.files/favicon-044be391.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><rustdoc-topbar><h2><a href="#">Module sqrt</a></h2></rustdoc-topbar><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../../libm/index.html">libm</a><span class="version">0.2.15</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Module sqrt</a></h2><h3><a href="#enums">Module Items</a></h3><ul class="block"><li><a href="#enums" title="Enums">Enums</a></li><li><a href="#statics" title="Statics">Statics</a></li><li><a href="#traits" title="Traits">Traits</a></li><li><a href="#functions" title="Functions">Functions</a></li></ul></section><div id="rustdoc-modnav"><h2><a href="../index.html">In libm::<wbr>math::<wbr>generic</a></h2></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="../../../index.html">libm</a>::<wbr><a href="../../index.html">math</a>::<wbr><a href="../index.html">generic</a></div><h1>Module <span>sqrt</span>&nbsp;<button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../../../src/libm/math/generic/sqrt.rs.html#4-541">Source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Generic square root algorithm.</p>
<p>This routine operates around <code>m_u2</code>, a U.2 (fixed point with two integral bits) mantissa
within the range [1, 4). A table lookup provides an initial estimate, then goldschmidt
iterations at various widths are used to approach the real values.</p>
<p>For the iterations, <code>r</code> is a U0 number that approaches <code>1/sqrt(m_u2)</code>, and <code>s</code> is a U2 number
that approaches <code>sqrt(m_u2)</code>. Recall that m_u2 âˆˆ [1, 4).</p>
<p>With Newton-Raphson iterations, this would be:</p>
<ul>
<li><code>w = r * r           w ~ 1 / m</code></li>
<li><code>u = 3 - m * w       u ~ 3 - m * w = 3 - m / m = 2</code></li>
<li><code>r = r * u / 2       r ~ r</code></li>
</ul>
<p>(Note that the righthand column does not show anything analytically meaningful (i.e. r ~ r),
since the value of performing one iteration is in reducing the error representable by <code>~</code>).</p>
<p>Instead of Newton-Raphson iterations, Goldschmidt iterations are used to calculate
<code>s = m * r</code>:</p>
<ul>
<li><code>s = m * r           s ~ m / sqrt(m)</code></li>
<li><code>u = 3 - s * r       u ~ 3 - (m / sqrt(m)) * (1 / sqrt(m)) = 3 - m / m = 2</code></li>
<li><code>r = r * u / 2       r ~ r</code></li>
<li><code>s = s * u / 2       s ~ s</code></li>
</ul>
<p>The above is precise because it uses the original value <code>m</code>. There is also a faster version
that performs fewer steps but does not use <code>m</code>:</p>
<ul>
<li><code>u = 3 - s * r       u ~ 3 - 1</code></li>
<li><code>r = r * u / 2       r ~ r</code></li>
<li><code>s = s * u / 2       s ~ s</code></li>
</ul>
<p>Rounding errors accumulate faster with the second version, so it is only used for subsequent
iterations within the same width integer. The first version is always used for the first
iteration at a new width in order to avoid this accumulation.</p>
<p>Goldschmidt has the advantage over Newton-Raphson that <code>sqrt(x)</code> and <code>1/sqrt(x)</code> are
computed at the same time, i.e. there is no need to calculate <code>1/sqrt(x)</code> and invert it.</p>
</div></details><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">Â§</a></h2><dl class="item-table"><dt><a class="enum" href="enum.Exp.html" title="enum libm::math::generic::sqrt::Exp">Exp</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dd>Representation of whether we shift the exponent into a <code>u32</code>, or modify it in place to save
the shift operations.</dd></dl><h2 id="statics" class="section-header">Statics<a href="#statics" class="anchor">Â§</a></h2><dl class="item-table"><dt><a class="static" href="static.RSQRT_TAB.html" title="static libm::math::generic::sqrt::RSQRT_TAB">RSQRT_<wbr>TAB</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dd>A U0.16 representation of <code>1/sqrt(x)</code>.</dd></dl><h2 id="traits" class="section-header">Traits<a href="#traits" class="anchor">Â§</a></h2><dl class="item-table"><dt><a class="trait" href="trait.SqrtHelper.html" title="trait libm::math::generic::sqrt::SqrtHelper">Sqrt<wbr>Helper</a></dt><dd>Size-specific constants related to the square root routine.</dd></dl><h2 id="functions" class="section-header">Functions<a href="#functions" class="anchor">Â§</a></h2><dl class="item-table"><dt><a class="fn" href="fn.goldschmidt.html" title="fn libm::math::generic::sqrt::goldschmidt">goldschmidt</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dd>Perform <code>count</code> goldschmidt iterations, returning <code>(r_u0, s_u?)</code>.</dd><dt><a class="fn" href="fn.sqrt.html" title="fn libm::math::generic::sqrt::sqrt">sqrt</a></dt><dt><a class="fn" href="fn.sqrt_round.html" title="fn libm::math::generic::sqrt::sqrt_round">sqrt_<wbr>round</a></dt><dt><a class="fn" href="fn.wmulh.html" title="fn libm::math::generic::sqrt::wmulh">wmulh</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dd>Multiply at the wider integer size, returning the high half.</dd></dl></section></div></main></body></html>