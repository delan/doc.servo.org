<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Scene building"><title>webrender::scene_building - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2"href="../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../static.files/rustdoc-e56847b5.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="webrender" data-themes="" data-resource-suffix="" data-rustdoc-version="1.91.0 (f8297e351 2025-10-28)" data-channel="1.91.0" data-search-js="search-e256b49e.js" data-stringdex-js="stringdex-c3e638e9.js" data-settings-js="settings-c38705f0.js" ><script src="../../static.files/storage-e2aeef58.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../static.files/main-6dc2a7f3.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-263c88ec.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-eab170b8.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-044be391.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><rustdoc-topbar><h2><a href="#">Module scene_building</a></h2></rustdoc-topbar><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../webrender/index.html">webrender</a><span class="version">0.68.0</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Module scene_<wbr>building</a></h2><h3><a href="#">Sections</a></h3><ul class="block top-toc"><li><a href="#scene-building" title="Scene building">Scene building</a></li><li><a href="#general-algorithm" title="General algorithm">General algorithm</a></li></ul><h3><a href="#structs">Module Items</a></h3><ul class="block"><li><a href="#structs" title="Structs">Structs</a></li><li><a href="#enums" title="Enums">Enums</a></li><li><a href="#traits" title="Traits">Traits</a></li><li><a href="#functions" title="Functions">Functions</a></li></ul></section><div id="rustdoc-modnav"><h2 class="in-crate"><a href="../index.html">In crate webrender</a></h2></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="../index.html">webrender</a></div><h1>Module <span>scene_<wbr>building</span>&nbsp;<button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../src/webrender/scene_building.rs.html#5-5001">Source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h2 id="scene-building"><a class="doc-anchor" href="#scene-building">Â§</a>Scene building</h2>
<p>Scene building is the phase during which display lists, a representation built for
serialization, are turned into a scene, webrenderâ€™s internal representation that is
suited for rendering frames.</p>
<p>This phase is happening asynchronously on the scene builder thread.</p>
<h2 id="general-algorithm"><a class="doc-anchor" href="#general-algorithm">Â§</a>General algorithm</h2>
<p>The important aspects of scene building are:</p>
<ul>
<li>Building up primitive lists (much of the cost of scene building goes here).</li>
<li>Creating pictures for content that needs to be rendered into a surface, be it so that
filters can be applied or for caching purposes.</li>
<li>Maintaining a temporary stack of stacking contexts to keep track of some of the
drawing states.</li>
<li>Stitching multiple display lists which reference each other (without cycles) into
a single scene (see build_reference_frame).</li>
<li>Interning, which detects when some of the retained state stays the same between display
lists.</li>
</ul>
<p>The scene builder linearly traverses the serialized display list which is naturally
ordered back-to-front, accumulating primitives in the top-most stacking contextâ€™s
primitive list.
At the end of each stacking context (see pop_stacking_context), its primitive list is
either handed over to a picture if one is created, or it is concatenated into the parent
stacking contextâ€™s primitive list.</p>
<p>The flow of the algorithm is mostly linear except when handling:</p>
<ul>
<li>shadow stacks (see push_shadow and pop_all_shadows),</li>
<li>backdrop filters (see add_backdrop_filter)</li>
</ul>
</div></details><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">Â§</a></h2><dl class="item-table"><dt><a class="struct" href="struct.CompositeOps.html" title="struct webrender::scene_building::CompositeOps">Composite<wbr>Ops</a></dt><dt><a class="struct" href="struct.ExtendedPrimitiveInstance.html" title="struct webrender::scene_building::ExtendedPrimitiveInstance">Extended<wbr>Primitive<wbr>Instance</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dd>A primitive instance + some extra information about the primitive. This is
stored when constructing 3d rendering contexts, which involve cutting
primitive lists.</dd><dt><a class="struct" href="struct.FlattenedStackingContext.html" title="struct webrender::scene_building::FlattenedStackingContext">Flattened<wbr>Stacking<wbr>Context</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dd>Properties of a stacking context that are maintained
during creation of the scene. These structures are
not persisted after the initial scene build.</dd><dt><a class="struct" href="struct.NodeIdToIndexMapper.html" title="struct webrender::scene_building::NodeIdToIndexMapper">Node<wbr>IdTo<wbr>Index<wbr>Mapper</a></dt><dd>A data structure that keeps track of mapping between API Ids for spatials and the indices
used internally in the SpatialTree to avoid having to do HashMap lookups for primitives
and clips during frame building.</dd><dt><a class="struct" href="struct.PendingPrimitive.html" title="struct webrender::scene_building::PendingPrimitive">Pending<wbr>Primitive</a></dt><dd>A primitive that is added while a shadow context is
active is stored as a pending primitive and only
added to pictures during pop_all_shadows.</dd><dt><a class="struct" href="struct.PendingShadow.html" title="struct webrender::scene_building::PendingShadow">Pending<wbr>Shadow</a></dt><dd>As shadows are pushed, they are stored as pending
shadows, and handled at once during pop_all_shadows.</dd><dt><a class="struct" href="struct.PictureChainBuilder.html" title="struct webrender::scene_building::PictureChainBuilder">Picture<wbr>Chain<wbr>Builder</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dd>Helper struct to build picture chains during scene building from
a flattened stacking context struct.</dd><dt><a class="struct" href="struct.SceneBuilder.html" title="struct webrender::scene_building::SceneBuilder">Scene<wbr>Builder</a></dt><dd>A structure that converts a serialized display list into a form that WebRender
can use to later build a frame. This structure produces a BuiltScene. Public
members are typically those that are destructured into the BuiltScene.</dd><dt><a class="struct" href="struct.SceneRecycler.html" title="struct webrender::scene_building::SceneRecycler">Scene<wbr>Recycler</a></dt><dd>A helper for reusing the scene builderâ€™s memory allocations and dropping
scene allocations on the scene builder thread to avoid lock contention in
jemalloc.</dd><dt><a class="struct" href="struct.ScrollOffsetMapper.html" title="struct webrender::scene_building::ScrollOffsetMapper">Scroll<wbr>Offset<wbr>Mapper</a></dt><dd>Offsets primitives (and clips) by the external scroll offset
supplied to scroll nodes.</dd><dt><a class="struct" href="struct.SliceFlags.html" title="struct webrender::scene_building::SliceFlags">Slice<wbr>Flags</a></dt><dd>Slice flags</dd><dt><a class="struct" href="struct.StackingContextInfo.html" title="struct webrender::scene_building::StackingContextInfo">Stacking<wbr>Context<wbr>Info</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dd>Internal tracking information about the currently pushed stacking context.
Used to track what operations need to happen when a stacking context is popped.</dd></dl><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">Â§</a></h2><dl class="item-table"><dt><a class="enum" href="enum.PictureSource.html" title="enum webrender::scene_building::PictureSource">Picture<wbr>Source</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dd>Represents the current input for a picture chain builder (either a
prim list from the stacking context, or a wrapped picture instance).</dd><dt><a class="enum" href="enum.ShadowItem.html" title="enum webrender::scene_building::ShadowItem">Shadow<wbr>Item</a></dt></dl><h2 id="traits" class="section-header">Traits<a href="#traits" class="anchor">Â§</a></h2><dl class="item-table"><dt><a class="trait" href="trait.CreateShadow.html" title="trait webrender::scene_building::CreateShadow">Create<wbr>Shadow</a></dt><dt><a class="trait" href="trait.IsVisible.html" title="trait webrender::scene_building::IsVisible">IsVisible</a></dt></dl><h2 id="functions" class="section-header">Functions<a href="#functions" class="anchor">Â§</a></h2><dl class="item-table"><dt><a class="fn" href="fn.create_prim_instance.html" title="fn webrender::scene_building::create_prim_instance">create_<wbr>prim_<wbr>instance</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dt><a class="fn" href="fn.filter_datas_for_compositing.html" title="fn webrender::scene_building::filter_datas_for_compositing">filter_<wbr>datas_<wbr>for_<wbr>compositing</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dt><a class="fn" href="fn.filter_ops_for_compositing.html" title="fn webrender::scene_building::filter_ops_for_compositing">filter_<wbr>ops_<wbr>for_<wbr>compositing</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dt><a class="fn" href="fn.filter_primitives_for_compositing.html" title="fn webrender::scene_building::filter_primitives_for_compositing">filter_<wbr>primitives_<wbr>for_<wbr>compositing</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dt><a class="fn" href="fn.process_repeat_size.html" title="fn webrender::scene_building::process_repeat_size">process_<wbr>repeat_<wbr>size</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dt><a class="fn" href="fn.read_gradient_stops.html" title="fn webrender::scene_building::read_gradient_stops">read_<wbr>gradient_<wbr>stops</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt></dl></section></div></main></body></html>